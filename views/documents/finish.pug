extends ../layout

block content

  div(class='container-fluid')

    if current_user
        if document
          if document.status !== 'metadata'
            button.blue.btn.btn-primary.waves-effect.waves-light#reopen_document.btn.btn-primary
             <i class="fas fa-undo-alt"></i> Reopen document
            button.blue.btn.btn-primary.waves-effect.waves-light(type='button' id='getPublicURL' style='margin-left:10px;' title='Copy URL to clipboard')
              <i class="fas fa-link"></i> Get public URL of this document
            input.form-control.hidden(type='text' id='public_url' name='public_url' value=publicURL)
            a(href='mailto:?subject='+ encodeURIComponent(mail.subject) + '&body=' + encodeURIComponent(mail.body) target='_blank')
              button.blue.btn.btn-primary.waves-effect.waves-light(type='button' id='getPublicURL' style='margin-left:10px;' title='Send URL by email')
                <i class="far fa-envelope"></i> Share with colleague
            if(current_user.role.label === "standard_user")
              a(href='https://docs.google.com/forms/d/e/1FAIpQLScRVw-GPA-15VVrYFADXJUKByA7SV5oDwv6ynAjOxt2W5QT7A/viewform?usp=sf_link' id='standard_user_feedback_link' target='_blank')
                button.btn.btn-primary.waves-effect.waves-light.bg-primary(type='button' id='getPublicURL' style='margin-left:10px;' title='Send URL by email') Give feedback about your DataSeer experience
            else
              a(href='https://docs.google.com/forms/d/e/1FAIpQLSeURLXaNchVJEawPaiBrC--cM2mXc1zMEcaR4hu8MZyv44nHw/viewform?usp=sf_link' id='annotator_feedback_link' target='_blank')
                button.btn.btn-primary.waves-effect.waves-light.bg-primary(type='button' id='getPublicURL' style='margin-left:10px;' title='Send URL by email') Annotator feedback

    if document.isDataSeer
      
      div(class='row')
        div(class='col-12') Many thanks for using DataSeer. The Data Accessibility section for your article is below, please paste this into the next version your article.

          div(class='container-fluid')

            div(class='row row-margin')
              div(class='col-12')
                div(class='key d-inline') Data Availability Statement: 
                each dataset in document.datasets.current

                  div(class='row')
                    div(class='col-12')
                      if dataset.DOI && dataset.name
                        div(class='value d-block') #{dataset.name}: 
                          a(href=dataset.DOI) #{dataset.DOI}

      div(class='row')
        div(class='col-12') The report below has been sent to the journal Editorial Office:
          div(class='container-fluid')

            div(class='row')
              div(class='col-12') Manuscript #: #{document.metadata.manuscript_id}

            div(class='row row-margin')
              div(class='col-12')
                div(class='key d-inline') Data Availability Statement: 
                each dataset in document.datasets.current

                  div(class='row')
                    div(class='col-12')
                      if dataset.DOI && dataset.name
                        div(class='value d-block') #{dataset.name}: 
                          a(href=dataset.DOI) #{dataset.DOI}

            div(class='row row-margin')
              div(class='col-12') Author Comments: 
                each dataset in document.datasets.current

                  div(class='row')
                    div(class='col-12')
                      if dataset.comments
                        div(class='value d-block') #{dataset.name}: #{dataset.comments}

    else

      div(class='row row-margin')
        div(class='col-12')
          div(class='key d-inline font-weight-bold') Suggested Data Availability Statement: 
      
      div(class='row row-margin')
        each dataset in document.datasets.current
          if dataset.DOI && dataset.name
            div(class='col-12')
                div(class='value d-block' style="margin-bottom: 4px;") #{dataset.name}: 
                  a(href=dataset.DOI) #{dataset.DOI}
          else if dataset.comments && dataset.name
            div(class='col-12')
                div(class='value d-block' style="margin-bottom: 4px;") #{dataset.name}: #{dataset.comments}

      div(class='row row-margin')
        if document.metadata.authors.length > 0
          div(class='col-12')
            div(class='key d-inline font-weight-bold') Authors: 
              div(class='value d-block authors-container')
                ul
                  each val, index in document.metadata.authors
                    if val.name
                      if (val.email)
                        <li> #{val.name} (<strong>#{val.email}</strong>)
                      else
                        li #{val.name}
                      ul
                        if val.name && val.affiliations
                          each aff, index in val.affiliations
                            li #{aff}
        div(class='col-12')
          div(class='key d-inline font-weight-bold') Title: 
          div(class='value d-inline') #{document.metadata.article_title}
        div(class='col-12')
          div(class='key d-inline font-weight-bold') Manuscript #: 
          div(class='value d-inline') #{document.metadata.manuscript_id}
        div(class='col-12')
          div(class='key d-inline font-weight-bold') Submitting Author: 
          div(class='value d-inline') #{document.metadata.submitting_author}
        div(class='col-12')
          div(class='key d-inline font-weight-bold') Submitting Author email: 
          div(class='value d-inline') #{document.metadata.submitting_author_email}

      div(class='row row-margin')
        div(class='col-12')
          div(class='key d-inline font-weight-bold') Datasets:

      div(class='row')
        div(class='col-12')
          div(class='key d-inline')
          each dataset, index in document.datasets.current

            div(class='row row-margin')
              div(class='col-12')
                div(class='value d-block font-weight-bold') Dataset #{index+1}:
              div(class='col-12')
                div(class='value d-inline') Data Type: 
                if dataset.subType !== ''
                  div(class='value d-inline') #{dataset.dataType} - #{dataset.subType}
                else
                  div(class='value d-inline') #{dataset.dataType}
              div(class='col-12')
                div(class='value d-inline') Data Sentence: 
                div(class='value d-inline') #{dataset.text}
              if dataset.name
                div(class='col-12')
                  div(class='value d-inline') Dataset name: 
                  div(class='value d-inline') #{dataset.name}
              if dataset.DOI
                div(class='col-12')
                  div(class='value d-inline') Stable Identifier: 
                  div(class='value d-inline')
                    a(href=dataset.DOI) #{dataset.DOI}
              if dataset.comments
                div(class='col-12')
                  div(class='value d-inline') Comments: 
                  div(class='value d-inline') #{dataset.comments}

    div(class='row row-margin')
      div(class='col-12')
        div(class='key d-inline font-weight-bold') Datasets deleted:
        if document.datasets.deleted.length === 0
          div(class='row row-margin')
            div(class='col-12')
              div(class='value d-block') None
    each dataset in document.datasets.deleted
      div(class='row row-margin')
        div(class='col-12')
          if dataset.dataType
            div(class='value d-inline') Data Type: 
            if dataset.subType !== ''
              div(class='value d-inline') #{dataset.dataType} - #{dataset.subType}
            else
              div(class='value d-inline') #{dataset.dataType}
        div(class='col-12')
          if dataset.subType
            div(class='value d-inline') Data Subtype: 
            div(class='value d-inline') #{dataset.subType}
        div(class='col-12')
          if dataset.text
            div(class='value d-inline') Data Sentence: 
            div(class='value d-inline') #{dataset.text}